<script src="https://unpkg.com/matter-js@0.18.0/build/matter.js" type="text/javascript"></script>
<p>
  Left click for orb to push stuff - Right click to spawn objs
</p>
<script>
// Main matter.js stuff
var Engine = Matter.Engine // https://github.com/liabru/matter-js/blob/master/src/core/Engine.js
var Render = Matter.Render // https://github.com/liabru/matter-js/blob/master/src/render/Render.js
var Runner = Matter.Runner // https://github.com/liabru/matter-js/blob/master/src/core/Runner.js
var Bodies = Matter.Bodies // https://github.com/liabru/matter-js/blob/master/src/body/Body.js
var Composite = Matter.Composite // https://github.com/liabru/matter-js/blob/master/src/body/Composite.js
var Events = Matter.Events // https://github.com/liabru/matter-js/blob/master/src/core/Events.js
var MouseConstraint = Matter.MouseContraint // https://github.com/liabru/matter-js/blob/master/src/constraint/MouseConstraint.js
var Contraint = Matter.Contraint // https://github.com/liabru/matter-js/blob/master/src/constraint/Constraint.js
var Mouse = Matter.Mouse // https://github.com/liabru/matter-js/blob/master/src/core/Mouse.js

// Defining the world
var engine = Engine.create({
	gravity: {
  	x: 0,
    y: 1,
  }
})
var render = Render.create({
	element: document.body,
  engine: engine,
  options: {
  	
  },
})
var mouse = Mouse.create(document.body)

function randInt(min,max){
	return Math.floor(Math.random()*(max-min+1))+min
}

function randShapes(count,isStatic,pos){
	var shapes = []
	for(var i=0;i<count;i++){
  	var x = randInt(0,render.options.width)
    var y = randInt(0,render.options.height)
    var sides = randInt(0,10)
    var radius = randInt(1,20)
    var static = isStatic
    if(pos){x=pos.x;y=pos.y}
    if(static=="rand"){if(randInt(0,1)==0){static=true}else{static=false}}
  	var shape = Bodies.polygon(x,y,sides,radius,{isStatic:static})
    shapes.push(shape)
  }
  Composite.add(engine.world,shapes)
}

function init(){
	var ground = Bodies.rectangle(400,610,810,60,{isStatic:true})
  var mouse = Bodies.circle(-100,-100,20,{isStatic:true,label:'Mouse'})
	Composite.add(engine.world,[ground,mouse])
  randShapes(100,false)
}

init()

Render.run(render)
var runner = Runner.create()
Runner.run(runner,engine)

Events.on(engine,'afterUpdate',()=>{
	var bounds = {x: render.options.width, y: render.options.height}
  engine.world.bodies.forEach(body=>{
  	if(body.label=="Mouse"){
    	if(mouse.button==0){
      	Matter.Body.setPosition(body,mouse.position)
      }
      if(mouse.button==-1){
      	Matter.Body.setPosition(body, Matter.Vector.create(-100,-100))
      }
      if(mouse.button==2){
      	//Matter.Body.set(body, "circleRadius", body.circleRadius+1)
        randShapes(1,false,mouse.position)
      }
      /*
      if(mouse.button==1 && !!body.circleRadius-1>0){
      	Matter.Body.set(body, "circleRadius", body.circleRadius-1)
      }
      */
    }
  	if(body.isStatic!=true){
      if( body.position.x <= 5 ){Matter.Body.setPosition(body, Matter.Vector.create(bounds.x-20,body.position.y) );}
      if( body.position.x >= bounds.x ){Matter.Body.setPosition(body, Matter.Vector.create(20,body.position.y) );}
      if( body.position.y <= 5 ){Matter.Body.setPosition(body, Matter.Vector.create(body.position.x,bounds.y-20) );}
      if( body.position.y >= bounds.y ){Matter.Body.setPosition(body, Matter.Vector.create(body.position.x,20) );}
    }
  })
})
</script>
