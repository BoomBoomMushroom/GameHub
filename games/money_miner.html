<center>
  <h1>Gameshub Coin Miner</h1>
  <button id="mineBtn" onclick="mine()"> Mine </button>
  <p id="timer" style="font-size:30px"> 0:00 Left until able to mine again </p>
  <p id="balance" style="font-size:30px"> 0 Coins earned so far! </p>
</center>

<script src="https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/js_modules/HttpFetcher.js"></script>

<style>
  body{
     background-color: #333333;
     user-select: none;
  }
  h1,h2,h3,p,input{
    background-color: #333333;
    color: white;
  }
  button{
    border-radius: 10px;
    font-size: 50px;
  }
</style>
<script>
  var timeLeft = 0;
var coinsEarned = 0;
var token = getCookie("accToken")

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
function httpFetchJSON(url,callback,onError){
	fetch(url)
  .then(response=>response.json())
  .then(data=>callback(data))
  .catch(error=>onError(error))
}
function httpFetchText(url,callback,onError){
	fetch(url)
  .then(response=>response.text())
  .then(data=>callback(data))
  .catch(error=>onError(error))
}

function mine(){
	if( 0 >= timeLeft ){
  	timeLeft = 300
    var coinUrl = "https://Gameshub-API.boomboommushroom.repl.co/awardmoney?token="+token+"&amount=1"
    httpFetchText(coinUrl,(data)=>{
    	console.log(data)
  		coinsEarned ++
    },(err)=>{
    	console.log(err.message)
	coinsEarned ++
    })
  }
}
function update(){
	timeLeft -= 1
  var tim = new Date(timeLeft * 1000).toISOString().substr(11, 8).substr(3,10);
  if(timeLeft>=0){timer.innerText = tim;}
  else{
  	timer.innerText = "Click 'Mine' to mine another gameshub coin!"
  }
  if(coinsEarned!=1){
  	balance.innerText = coinsEarned+" Coins earned so far!"
  } else{
  	balance.innerText = "1 Coin earned so far!"
  }
}
setInterval(update,1000)
</script>
