<center>
    <div onclick="openBox()" id="box" class="box">
      <h1 class="boxText">?</h1>
    </div>
  </center>
  
  <center id="itemData" style="display:none">  
    <a class="lightbox" href="#image"><img id="itemImage1" src="https://via.placeholder.com/150"/></a>
    <div class="lightbox-target" id="image"><img id="itemImage2" src="https://via.placeholder.com/150"/><a class="lightbox-close" href="#"></a></div>
    
    <!--
    <h1>
      <span class="common">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="uncommon">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="rare">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="epic">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="legendary">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="mythic">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="derpy">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="supaDuperLegendary">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="void">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    <h1>
      <span class="ultraRareSuperDeluxeTM">[RARITY] </span>
      <span class="itemName">Item Name</span>
    </h1>
    -->
  </center>
  
  <style>
  body{
    background-color: #333333;
    color: white;
    user-select: none;
  }
  img{ border: 2px solid black; }
  span{ font-family: "Lucida Console", "Courier New", monospace; }
  
  .common{ color: gray; }
  .uncommon{ color: green; }
  .rare{ color: blue; }
  .epic{ color: purple; }
  .legendary{ color: gold; text-shadow: 0 0 10px gold, 0 0 20px gold; }
  .mythic{ color: red; text-shadow: 0 0 10px red, 0 0 20px red; }
  .derpy{ color: #9c7041; text-shadow: 0 0 10px #9c7041, 0 0 20px #9c7041, 0 0 30px #9c7041, 0 0 40px #9c7041; }
  .supaDuperLegendary{ color: #bf4eb2; text-shadow: 0 0 10px #bf4eb2, 0 0 20px #bf4eb2, 0 0 30px #bf4eb2, 0 0 40px #bf4eb2; }
  .void{ color: black; text-shadow: 0 0 10px black, 0 0 20px black, 0 0 30px black, 0 0 40px black; }
  .ultraRareSuperDeluxeTM{ color: orange; text-shadow: 0 0 10px orange, 0 0 20px orange, 0 0 30px orange, 0 0 40px orange; }
  
  .box{
    width: 150px;
    height: 150px;
    background-color: orange;
    border-radius: 25%;
    box-shadow: 20px 20px 60px 0px #000000;
  }
  .boxText{
    padding: 55px;
    font-size: 6vw;
    width: fit-content;
  block-size: fit-content;
  }
  
  .animateOpen{
    animation-name: boxOpen;
    animation-duration: 2s;
  }
  
  @keyframes boxOpen{
    0%   { transform: scale(1.5) }
    12.5%   { transform: scale(1) }
    
    25%   { transform: scale(1.5) }
    37.5%   { transform: scale(1) }
    
    50%   { transform: scale(1.5) }
    62.5%   { transform: scale(1) }
    
    75%   { transform: scale(1.5) }
    87.5%   { transform: scale(7) }
    
    100% { transform: scale(7) }
  }
  </style>
  
  <style>
  /*Eliminates padding, centers the thumbnail */
  body, html {
  padding: 0;
  margin: 0;
  text-align: center;
  }
  
  /* Styles the thumbnail */
  
  a.lightbox img {
  border: 3px solid white;
  box-shadow: 0px 0px 8px rgba(0,0,0,.3);
  margin: 94px 20px 20px 20px;
  }
  
  /* Styles the lightbox, removes it from sight and adds the fade-in transition */
  
  .lightbox-target {
  position: fixed;
  top: -100%;
  width: 100%;
  background: rgba(0,0,0,.7);
  width: 100%;
  opacity: 0;
  -webkit-transition: opacity .5s ease-in-out;
  -moz-transition: opacity .5s ease-in-out;
  -o-transition: opacity .5s ease-in-out;
  transition: opacity .5s ease-in-out;
  overflow: hidden;
   
  }
  
  /* Styles the lightbox image, centers it vertically and horizontally, adds the zoom-in transition and makes it responsive using a combination of margin and absolute positioning */
  
  .lightbox-target img {
  margin: auto;
  position: absolute;
  top: 0;
  left:0;
  right:0;
  bottom: 0;
  max-height: 0%;
  max-width: 0%;
  border: 3px solid white;
  box-shadow: 0px 0px 8px rgba(0,0,0,.3);
  box-sizing: border-box;
  -webkit-transition: .5s ease-in-out;
  -moz-transition: .5s ease-in-out;
  -o-transition: .5s ease-in-out;
  transition: .5s ease-in-out;
    
  }
  
  /* Styles the close link, adds the slide down transition */
  
  a.lightbox-close {
    display: block;
    width:50px;
    height:50px;
    box-sizing: border-box;
    background: white;
    color: black;
    text-decoration: none;
    position: absolute;
    top: -80px;
    right: 0;
    -webkit-transition: .5s ease-in-out;
    -moz-transition: .5s ease-in-out;
    -o-transition: .5s ease-in-out;
    transition: .5s ease-in-out;
  }
  
  /* Provides part of the "X" to eliminate an image from the close link */
  
  a.lightbox-close:before {
    content: "";
    display: block;
    height: 30px;
    width: 1px;
    background: black;
    position: absolute;
    left: 26px;
    top:10px;
    -webkit-transform:rotate(45deg);
    -moz-transform:rotate(45deg);
    -o-transform:rotate(45deg);
    transform:rotate(45deg);
  }
  
  /* Provides part of the "X" to eliminate an image from the close link */
  
  a.lightbox-close:after {
    content: "";
    display: block;
    height: 30px;
    width: 1px;
    background: black;
    position: absolute;
    left: 26px;
    top:10px;
    -webkit-transform:rotate(-45deg);
    -moz-transform:rotate(-45deg);
    -o-transform:rotate(-45deg);
    transform:rotate(-45deg);
  }
  
  /* Uses the :target pseudo-class to perform the animations upon clicking the .lightbox-target anchor */
  
  .lightbox-target:target {
    opacity: 1;
    top: 0;
    bottom: 0;
    overflow:scroll;
  }
  
  .lightbox-target:target img {
  max-height: 100%;
  max-width: 100%;
  }
  
  .lightbox-target:target a.lightbox-close {
  top: 0;
  }
  </style>

<script>
const rarities = ["common","uncommon","rare","epic","legendary","mythic", "derpy", "supa Duper Legendary", "void", "ultra Rare Super DeluxeTM"]

const itemImage = document.getElementById("itemImage1")
itemImage.addEventListener("load",()=>{
	setInterval(()=>{
  	var imageRatio = itemImage.width / itemImage.height
  	itemImage.width = window.innerWidth * 0.25
  },100)
})

function updateRarity(){
  for(var i=0;i<rarities.length;i++){
    var b = rarities[i].replaceAll(" ","")
    var a = document.getElementsByClassName(b)
    for(var j=0;j<a.length;j++){
      a[j].innerText = "["+ addFullTitles(titleCase(rarities[i])) +"] "
      //a[j].parentElement.getElementsByClassName("itemName")[0].innerText = ""
    }
  }
}


function titleCase(string) {
  var sentence = string.toLowerCase().split(" ");
	for(var i = 0; i< sentence.length; i++){
  	sentence[i] = sentence[i][0].toUpperCase() + sentence[i].slice(1);
  }
  return sentence.join(" ")
}
function addFullTitles(string){
	var s = string.replaceAll("tm", "â„¢")
  return s
}

function httpFetchJSON(url,callback,onError){
	fetch(url)
  .then(response=>response.json())
  .then(data=>callback(data))
  .catch(error=>onError(error))
}
function getCookie(cname){
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for (let i=0; i<ca.length;i++){
    let c = ca[i];
    while (c.charAt(0)==' '){
    c = c.substring(1);
    }
    if(c.indexOf(name)==0){
    return c.substring(name.length,c.length);
    }
  }
  return "";
}

httpFetchJSON("https://Gameshub-API.boomboommushroom.repl.co/getitems",(d)=>{
	var d = JSON.parse(d)
  window.items = d
  console.log("Loaded Items")
},(e)=>{console.error(e.message)})

function openBox(){
  var b = document.getElementById("box")
  b.getElementsByClassName("boxText")[0].innerText = "?"
  b.classList.add("animateOpen")
  setTimeout(()=>{
    b.classList.remove("animateOpen")
    httpFetchJSON("https://Gameshub-API.boomboommushroom.repl.co/openBox?token="+getCookie("accToken"),(d)=>{
      if(d.constructor == ({}).constructor){
      	loadItem(d.displayName)
    	b.getElementsByClassName("boxText")[0].innerText = d.displayName
      }
      else{
      	b.getElementsByClassName("boxText")[0].innerText = d
      }
      console.log(d)
    },(e)=>{console.error(e.message)})
  },2000)
}

function loadItem(itemName){
	document.getElementById("itemData").style.display = "block"

  var item = window.items[ itemName ]
  if(item == null){
  	var items = Object.keys(window.items)
  	var i = Math.floor(Math.random() * items.length)
  	item = window.items[ items[i] ]
  }
  
  var i = document.getElementById("itemData")
  
  var h1 = document.createElement("h1")
  var rarity = document.createElement("span")
  rarity.classList.add(item.rarity)
  var itemName = document.createElement("span")
  itemName.classList.add("itemName")
  itemName.innerText = item.displayName
  var br = document.createElement("br")
  var desc = document.createElement("i")
  desc.innerText = item.description
  document.getElementById("itemImage1").src = item.image
  document.getElementById("itemImage2").src = item.image
  
  i.appendChild(h1)
  h1.appendChild(rarity)
  h1.appendChild(itemName)
  h1.appendChild(br)
  h1.appendChild(desc)
  updateRarity()
} 
</script>