<link rel="icon" href="GamesHubLogo.png">

<h1 id="welcome">Welcome to GamesHub!</h1>

<!--
<ad class="ad">
  <abbr title="Empty Ad">
    <a href="temp_url">
      <img src="temp_img">
    </a>
  </abbr>
  <script>
    const ads = []
    const currentScript = document.currentScript
    const adTitle = currentScript.parentElement.getElementsByTagName("abbr")[0]
    const adLink = adTitle.getElementsByTagName("a")[0]
    const adImg = adLink.getElementsByTagName("img")[0]
    const ads_url = "https://api.github.com/repos/BoomBoomMushroom/GameHub/contents/ads/ads.json"
    function randInt(min,max){return Math.floor(Math.random()*(max-min)+min)}
    var ads_file_data
    fetch(ads_url).then(response=>response.json()).then(data=>{ads_file_data=data;dataCallback()}).catch(error=>{})
    function dataCallback(){
      ads_file_data.encryptedContent = ads_file_data.content
      ads_file_data.content = atob(ads_file_data.content)
      ads_file_data.jsonContent = JSON.parse(ads_file_data.content)
      ads_file_data.jsonContent.forEach(ele=>{ads.push(ele)})
      const ad = ads[randInt(0,ads.length)]
      if(ad){
      	adTitle.title = ad.title
        adLink.href = ad.redirect_url
        adImg.src = ad.img_src
      }
    }
  </script>
</ad>
-->

<div id="globalChat">
  <script>
	let HOST = 'wss://GameshubGlobalChat.academyofcode1.repl.co'
	// https://replit.com/@AcademyofCode1/GameshubGlobalCHat
  let ws = new WebSocket(HOST);
  let el;

  function heartbeat(){
  	clearTimeout(this.pingTimeout);
        
    this.pingTimeout = setTimeout(() => {
    	this.terminate()
    }, 30000);
	}
      
  var enterName = false
  ws.onmessage = function incoming(data) {
  	var msg = data.data
    addChat(msg)
	}
      
  ws.on('open', heartbeat);
  ws.on('ping', heartbeat);
  ws.on('close', function close() {
  	clearTimeout(this.pingTimeout);
	})
	</script>
  <style>
    #chatDiv{ position: absolute; border: 1px solid black; top: 45%; right: 1%; height: 45%; width: 50%; overflow: auto; background-color: #ffffff }
    #msgInput{ position: absolute; right: 20%; bottom: 1%; }
    #sendMsg{ position: absolute; right: 1%; bottom: 1%; }
  </style>

  <div class='chat' id="chatDiv"></div>
    
  <input class='chat' id="msgInput" placeholder='Type your message here...'>
  <button class='chat' id="sendMsg" onclick='sendMsg()'>Send Message</button>
  <script>
    function addChat(msg){
      const output = document.getElementById('chatDiv');
      var ele = document.createElement('P');
      ele.innerText = new Date().toTimeString().split(' ')[0] + " " + msg
      ele.style.wordWrap = 'break-word'
      output.appendChild(ele);
    }
    function sendMsg(){
      if(document.getElementById("msgInput").value!=""){
        ws.send("CHAT-"+document.getElementById("msgInput").value);
        document.getElementById("msgInput").value="";
      }
    }
    document.onkeypress = function (e) {
      e = e || window.event
      if(e.keyCode == 13){
        sendMsg();
      }
    }

    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length===2) return parts.pop().split(';').shift();
    }

    var a = setInterval(()=>{
      if(ws.readyState==ws.OPEN){
        var cookie = getCookie("accToken")
        if(cookie!=undefined){
          ws.send("token-"+cookie)
          clearInterval(a)
        }
      }
    },10)
  </script>
</div>

<style>
	body{
		background-image: url("https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background.png");
		background-repeat: repeat-y;
  		background-size: cover;
	}
	.ad{
		position: absolute;
		right:  20%;
		bottom: 10px;
	}
</style>
<script>
var e = ["https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background.png",
	 "https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background2.png",
	 "https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background3.png",
	"https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background4.png",
	"https://raw.githubusercontent.com/BoomBoomMushroom/GameHub/main/GamehubApi/images/GH_Background5.png"]
var rand = Math.floor( Math.random() * (e.length-0) )+0
document.body.style.backgroundImage="url('"+e[rand]+"')"
</script>

<!-- <iframe src="https://discord.com/widget?id=885976790038892584&theme=dark"  style="position:absolute;right:0px;top:50%;" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe> -->
<!-- Line break every 10 games -->

<p>Single Player Games</p>
<a href="https://gameshub.dev/snake"><button>Snake</button></a>
<a href="https://pet-the-dog.netlify.app/"><button>Pet the Dog!</button></a>
<a href="https://gameshub.dev/solarsystemsimulator"><button>Solar System Simulator</button></a>
<a href="https://custom-programming-language-creator.netlify.app"><button>Custom Programming Language Crearor</button></a>
<a href="https://gameshub.dev/market"><button>Market Simulator</button></a>
<a href="https://gameshub.dev/monpoke"><button>Monpoke</button></a>
<a href="http://gameshub.dev/pageCounter"><button>Page Counter</button></a>
<a href="https://gameshub.dev/snakeAiBattle"><button>You v.s Snake AI</button></a>
<a href="https://gameshub.dev/snakeEcosystem"><button>Snake based Ecosystem</button></a>
<a href="https://gameshub.dev/existance"><button>Existance Simulator</button></a>
<br>
<a href="https://gameshub.dev/RaycastingTest"><button>Pseudo 3D World -- Raycasting Test</button></a>
<a href='https://gameshub.dev/appleCollection'><button>The Apple Collection</button></a>
<a href="http://gameshub.dev/pageCounter3D"><button>Page Counter 3D</button></a>
<a href="http://gameshub.dev/stolenCode/pokemonEmulators"><button>Pokemon Emulator</button></a>
<a href="http://gameshub.dev/cicada_rpg/index"><button>Cicada Collection</button></a>
<a href="http://gameshub.dev/pixelArtMaker"><button>Pixel Art Maker</button></a>
<a href="http://gameshub.dev/snake_ai-v2"><button>Snake AI 2</button></a>
<a href="http://gameshub.dev/conways_game_of_life"><button>Conway's Game Of Life</button></a>
<a href="https://gameshub.dev/LogicCreator"><button>Logic Gate Creator</button></a>
<a href='https://gameshub.dev/SlayingSnowballs'><button>Slaying Snowballs</button></a>
<br>
<a href="https://gameshub.dev/wordle"><button>Wordle Copy Old</button></a>
<a href='https://gameshub.dev/wordleNew'><button>Wordle Copy</button></a>
<a href='https://gameshub.dev/wordleSolver'><button>Wordle Solver</button></a>
<a href='https://gameshub.dev/getting_over_it'><button>Getting Over It</button></a>
<a href='https://gameshub.dev/money_miner'><button>Money Miner</button></a>
<a href='https://gameshub.dev/dirtcollectingsimulator'><button>Dirt Collecting Simulator</button></a>


<br>
<br>

<p>Multiplayer Games</p>
<a href='https://gameshub.dev/ExistanceSimulator1D'><button>Existance Simulator 1D - Multiplayer</button></a>
<a href='https://gameshub.dev/existanceSimulator'><button>Existance Simulator 2D - Multiplayer</button></a>
<a href='https://gameshub.dev/ExistanceSimulator3D'><button>Existance Simulator 3D - Multiplayer</button></a>
<a href='https://gameshub.dev/place'><button>Gameshub Place</button></a>
<a href='https://gameshub.dev/gunGame'><button>Gun Game - GET MONEY</button></a>
<a href='https://gameshub.dev/blackjack'><button>BlackJack - GAMBLING</button></a>

<br>
<br>

<p>Gameshub Server Stuff</p>
<a href="https://gameshub.dev/GamehubApi/shop"><button>Gameshub Shop</button></a>
<a href="https://gameshub.dev/gamehubapi/signup"><button id="signupButton">Signup</button></a>
<a href="https://gameshub.dev/gamehubapi/signin"><button id="loginButton">Log in</button></a>
<a href="https://gameshub.dev/gamehubapi/accsearch"><button id="accSearchButton">Search Accounts</button></a>

<br>
<br>

<p>Dev-Build // Testing Builds of games</p>
<a href='https://gameshub.dev/movement3dTest'><button>THREE.js movement build</button></a>
<a href='https://gameshub.dev/matter_test'><button>Matter.js Test</button></a>
<a href='https://gameshub.dev/demoGameCreator'><button>Demo Game Creator</button></a>
<a href='https://gameshub.dev/cookies'><button>Cookies</button></a>

<br>
<br>

<p>Links</p>
<a href='https://github.com/Academy-of-Code/GameHub'>Gameshub source code here</a>
<br>
<a disabled href='https://api.gameshub.dev'>API: api.gameshub.dev</a>
<br>
<a href="" id="currentAcc"></a>
<br>
<button id="logout" onclick="setCookie('accToken','',365*10);location.reload()" id="currentAcc">Logout</button>

<script>
paragraphs = document.getElementsByTagName("p")
header1s = document.getElementsByTagName("h1")
links = document.getElementsByTagName("a")
labels = document.getElementsByTagName("label")

//document.body.style.background = darkmodeColor
for(var x=0;x<paragraphs.length;x++){
	para = paragraphs[x]
	para.style.color = "#ffffff"
	// para.classList.add("darkmode_text")
}
for(var x=0;x<header1s.length;x++){
	h1 = header1s[x]
	h1.style.color = "#ffffff"
	// para.classList.add("darkmode_text")
}
for(var x=0;x<links.length;x++){
	link = links[x]
	link.style.color = "#ffffff"
	// para.classList.add("darkmode_text")
}
for(var x=0;x<labels.length;x++){
	lab = labels[x]
	lab.style.color = "#ffffff"
	// para.classList.add("darkmode_text")
}
setInterval(()=>{
	modeEnable()
},50)
</script>

<script>
	function setCookie(cname, cvalue, exdays){
	  const d = new Date();
	  d.setTime(d.getTime() + (exdays*24*60*60*1000));
	  let expires = "expires="+d.toUTCString();
	  document.cookie = cname+"="+cvalue+";"+expires+";path=/";
	}
	function getCookie(cname){
	  let name = cname + "=";
	  let decodedCookie = decodeURIComponent(document.cookie);
	  let ca = decodedCookie.split(';');
	  for (let i=0; i<ca.length;i++){
		let c = ca[i];
	    while (c.charAt(0)==' '){
		c = c.substring(1);
	    }
	    if(c.indexOf(name)==0){
		return c.substring(name.length,c.length);
	    }
	  }
	  return "";
	}
	if(window.location.hostname!="gameshub.dev"){
		window.location = "https://gameshub.dev"
	}
	function modeEnable(){
		var monthList = ["January","February","March","April","May","June","July","August","September","October","November","December"];
		var d = new Date()
		var month = monthList[d.getMonth()]
		document.getElementById("welcome").innerHTML = "Welcome to GamesHub - "+month
	}
</script>

<script src="konami.js"></script>

<script>
	const URLS = ["https://gameshub-api.herokuapp.com","https://Gameshub-API.academyofcode1.repl.co"]
	fetch(URLS[0]+'/tokeninfo?token='+getCookie("accToken"),{})
	.then(response => response.text())
	.then(data => {
		console.log(JSON.parse(data))
		if(JSON.parse(data)=="COULDNT_FIND_TOKEN"){
			document.getElementById("currentAcc").href = "https://gameshub.dev/gamehubapi/signup"
			document.getElementById("currentAcc").innerHTML = "You are currently not signed in"
			document.getElementById("logout").style.display = "none"
		}
		else{
			document.getElementById("currentAcc").href = "https://gameshub.dev/gamehubapi/viewacc?q=" + JSON.parse(data).Username
			document.getElementById("currentAcc").innerHTML = "Currently signed in as " + JSON.parse(data).Username
			document.getElementById("tr1").style.display = "none"
			document.getElementById("tr2").style.display = "none"
		}
	})
	fetch(URLS[1]+'/tokeninfo?token='+getCookie("accToken"),{})
	.then(response => response.text())
	.then(data => {
		console.log(JSON.parse(data))
		if(JSON.parse(data)=="COULDNT_FIND_TOKEN"){
			document.getElementById("currentAcc").href = "https://gameshub.dev/gamehubapi/signup"
			document.getElementById("currentAcc").innerHTML = "You are currently not signed in"
			document.getElementById("logout").style.display = "none"
		}
		else{
			document.getElementById("currentAcc").href = "https://gameshub.dev/gamehubapi/viewacc?q=" + JSON.parse(data).Username
			document.getElementById("currentAcc").innerHTML = "Currently signed in as " + JSON.parse(data).Username
			document.getElementById("tr1").style.display = "none"
			document.getElementById("tr2").style.display = "none"
		}
	})
</script>

<script>
	// Announcement Maker
  	function setCookie(cname, cvalue, exdays){
	  const d = new Date();
	  d.setTime(d.getTime() + (exdays*24*60*60*1000));
	  let expires = "expires="+d.toUTCString();
	  document.cookie = cname+"="+cvalue+";"+expires+";path=/";
	}
	function getCookie(cname){
	  let name = cname + "=";
	  let decodedCookie = decodeURIComponent(document.cookie);
	  let ca = decodedCookie.split(';');
	  for (let i=0; i<ca.length;i++){
		let c = ca[i];
	    while (c.charAt(0)==' '){
		c = c.substring(1);
	    }
	    if(c.indexOf(name)==0){
		return c.substring(name.length,c.length);
	    }
	  }
	  return "";
	}
  
  async function validateAccount(c){
    const URLS = ["https://gameshub-api.herokuapp.com","https://Gameshub-API.academyofcode1.repl.co"]
    
    var token = getCookie("accToken")
    
    var r=await fetch(URLS[1]+'/tokeninfo?token='+token,{})
    .then(response => response.text())
    .then(data => {
      //console.log(JSON.parse(data))
      if(JSON.parse(data)!="COULDNT_FIND_TOKEN"){
        return JSON.parse(data)
      }
      else{ return {} }
    })
    var h = setInterval(()=>{
      if(r!=undefined){
        c(r,token)
        clearInterval(h)
      }
    },10)
  }
  
  // code form JavaScript section
  function httpFetchJSON(url,callback,onError){
    fetch(url)
    .then(response=>response.json())
    .then(data=>callback(data))
    .catch(error=>onError(error))
  }
  function httpFetchText(url,callback,onError){
    fetch(url)
    .then(response=>response.text())
    .then(data=>callback(data))
    .catch(error=>onError(error))
  }

  function f(){
    console.log("Code entered now checking accout!")

    // Validate Token
    validateAccount(contin)
    function contin(account,token){
      var isAdmin = account.IsAdmin == true
      if(!isAdmin) return
      console.log("The user is an Admin... proceeding")
      var announcement = ""
      var times = 0
      while(announcement==""){
        if(times>=5&&announcement==""){
          break
        }
        var a = prompt("Give an annoucement to send")
        if(a.replaceAll(" ", "")!=""){
          announcement = a
        }
        times++
      }
      if(announcement=="") return
      var announce_URL = "https://gameshub-api.academyofcode1.repl.co/announce"
      // takes 'token' and 'a' as params
      httpFetchText(announce_URL+"?token="+token+"&a="+announcement,s)
    }
    function s(data){
      console.log(data)
    }
  }

  const code = "W A S D ENTER".split(" ")
  const keycodes2 = {
    "W": 87,
    "A": 65,
    "S": 83,
    "D": 68,
    "ENTER": 13,
  }
  var codeIndex2 = 0
  var f = document.onkeydown
  document.onkeydown = function(event){
    f()
    const keyCode = event.keyCode
    //console.log(keyCode)
    var reqKeycode = keycodes2[code[codeIndex2]]
    if(codeIndex2>=code.length-1){f()}
    if(keyCode==reqKeycode){
      codeIndex2 += 1
    } else{
      codeIndex2 = 0
    }
  }
</script>

<script>
	//Show Annoucnement
	function setCookie(cname, cvalue, exdays){
	  const d = new Date();
	  d.setTime(d.getTime() + (exdays*24*60*60*1000));
	  let expires = "expires="+d.toUTCString();
	  document.cookie = cname+"="+cvalue+";"+expires+";path=/";
	}
	function getCookie(cname){
	  let name = cname + "=";
	  let decodedCookie = decodeURIComponent(document.cookie);
	  let ca = decodedCookie.split(';');
	  for (let i=0; i<ca.length;i++){
		let c = ca[i];
	    while (c.charAt(0)==' '){
		c = c.substring(1);
	    }
	    if(c.indexOf(name)==0){
		return c.substring(name.length,c.length);
	    }
	  }
	  return "";
	}
  function httpFetchJSON(url,callback,onError){
    fetch(url)
    .then(response=>response.json())
    .then(data=>callback(data))
    .catch(error=>onError(error))
  }
  function httpFetchText(url,callback,onError){
    fetch(url)
    .then(response=>response.text())
    .then(data=>callback(data))
    .catch(error=>onError(error))
  }
  
  httpFetchJSON("https://gameshub-api.academyofcode1.repl.co/getannouncement",(data)=>{
  	var currentEpoch = Math.ceil(Date.now()/1000)
    var lastAnnouncement = parseInt(getCookie("lastAnnouncement"))
    if(isNaN(lastAnnouncement)){
	setCookie("lastAnnouncement","0",365*20)
      showAnnouncement(data)
    }
    else if(data.timestamp != lastAnnouncement){
	showAnnouncement(data)
    }
  })
  
  function showAnnouncement(d){
  	alert(d.announcement)
    setCookie("lastAnnouncement",d.timestamp.toString(),365*20)
  }
</script>
<script src="./js_modules/moneyPlaying.js"></script>
